<!DOCTYPE html>
<html class="light" lang="zh-TW">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <script src="https://cdn.tailwindcss.com?plugins=forms"></script>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />

  <script>
    tailwind.config = {
      darkMode: "class",
      theme: {
        extend: {
          colors: {
            primary: "#39E079",
            bgLight: "#f6f8f7",
            bgDark: "#122017",
          },
          fontFamily: {
            display: ["Plus Jakarta Sans", "Noto Sans TC", "sans-serif"],
          },
          borderRadius: {
            xl: "1rem",
            full: "9999px",
          },
        },
      },
    };
  </script>

  <style>
    .custom-checkbox:checked {
      background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuCW1uRGFb2U_fWjuibbIwFGzdnzCMW2plnoF-UcdnSxv9cyX35ItvRiPOk1JlTurAiM3xjhTESA36_0ISyIZK2Z952BVYpYRYW0KhC_nvw608tPEV14j13uRdTkruBe5EARxf0j3FWMMuyqM-YeRF3BQNd9cPnS7jWHxhr2qkVBFCn1T_sU2ahq18B9PNh6rochfvn7cero7U7706Ke9RBGGc3fF8voiDy_neTzazuAnVNa-pk_GZVCjJMdxS03iCCE1cONd4SHeZU");
      background-size: 60%;
      background-repeat: no-repeat;
      background-position: center;
    }
  </style>

  <title>北海道冬旅清單</title>
</head>

<body class="bg-bgLight dark:bg-bgDark text-slate-900 dark:text-white font-display">
<div class="max-w-md mx-auto min-h-screen flex flex-col">

  <!-- Header -->
  <header class="sticky top-0 bg-white/80 dark:bg-bgDark/80 backdrop-blur p-4 flex justify-between items-center">
    <h1 class="text-lg font-bold">北海道冬旅清單</h1>
    <button id="themeBtn" class="material-symbols-outlined text-primary">dark_mode</button>
  </header>

  <!-- Progress -->
  <div class="p-6">
    <div class="bg-white dark:bg-slate-900 p-5 rounded-xl border">
      <div class="flex justify-between mb-2">
        <span class="text-sm text-slate-500">完成進度</span>
        <span id="remainText" class="text-sm text-slate-500">還有 0 項待辦</span>
      </div>
      <div class="text-2xl font-bold mb-3" id="percentText">0%</div>
      <div class="w-full h-3 bg-slate-200 dark:bg-slate-800 rounded-full">
        <div id="progressBar" class="h-3 bg-primary rounded-full transition-all" style="width:0%"></div>
      </div>
    </div>
  </div>

  <!-- List -->
  <main id="list" class="px-6 space-y-4 flex-1"></main>

  <!-- Save -->
  <footer class="p-6">
    <button onclick="save()" class="w-full h-14 bg-primary text-white rounded-xl font-bold">儲存進度</button>
    <p id="hint" class="text-center text-xs mt-2 text-slate-500"></p>
  </footer>
</div>

<script>
const STORAGE_KEY = "hokkaido_checklist_final";

const state = JSON.parse(localStorage.getItem(STORAGE_KEY)) ?? {
  sections: [
    {
      title: "文件",
      icon: "description",
      items: [
        "⭐ 台灣駕照正本＋日文譯本（缺一不可）",
        "護照正本",
        "機票確認單",
        "旅遊保險單",
        "JR Pass 兌換券"
      ].map(t => ({ text: t, done: false }))
    },
    {
      title: "禦寒裝備",
      icon: "ac_unit",
      items: [
        "發熱衣 (Heattech)",
        "防水防滑雪靴",
        "保暖手套 & 圍巾"
      ].map(t => ({ text: t, done: false }))
    },
    {
      title: "小孩用品",
      icon: "child_care",
      items: [
        "尿布 & 濕紙巾",
        "防風推車雨罩",
        "便攜式暖氣"
      ].map(t => ({ text: t, done: false }))
    },
    {
      title: "電子產品",
      icon: "devices",
      items: [
        "行動電源",
        "萬用插頭"
      ].map(t => ({ text: t, done: false }))
    }
  ]
};

function render() {
  const root = document.getElementById("list");
  root.innerHTML = "";
  let total = 0, done = 0;

  state.sections.forEach(sec => {
    const box = document.createElement("details");
    box.open = true;
    box.className = "bg-white dark:bg-slate-900 rounded-xl border";

    box.innerHTML = `
      <summary class="p-4 font-bold flex items-center gap-2 cursor-pointer">
        <span class="material-symbols-outlined text-primary">${sec.icon}</span>
        ${sec.title}
      </summary>
    `;

    sec.items.forEach(item => {
      total++;
      if (item.done) done++;

      const row = document.createElement("label");
      row.className = "flex items-center gap-3 px-4 py-3";

      row.innerHTML = `
        <input type="checkbox" class="custom-checkbox w-5 h-5 rounded-full border-2" ${item.done ? "checked" : ""}>
        <span>${item.text}</span>
      `;

      row.querySelector("input").onchange = e => {
        item.done = e.target.checked;
        render();
      };

      box.appendChild(row);
    });

    root.appendChild(box);
  });

  const percent = total ? Math.round(done / total * 100) : 0;
  document.getElementById("percentText").textContent = percent + "%";
  document.getElementById("remainText").textContent = `還有 ${total - done} 項待辦`;
  document.getElementById("progressBar").style.width = percent + "%";
}

function save() {
  localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
  document.getElementById("hint").textContent = "已儲存 ✔";
  setTimeout(()=>hint.textContent="",1500);
}

document.getElementById("themeBtn").onclick = () =>
  document.documentElement.classList.toggle("dark");

render();
</script>
</body>
</html>
